#include "jxlJob.h"

namespace JxlFrame
{
	CJxlJob::CJxlJob()
	{
		
	}
	
	CJxlJob::~CJxlJob()
	{
		
	}
	
	void CJxlJob::run()
	{
		
//		char * m_sUser = "cc";
//		char * m_sPassword = "cc";
//		char * m_sDsn = "cc";
//		char * m_sIP = "10.45.5.163";
//		int port = 17944;
//		
//		char sSQL[102400] = {0};
//		memset(sSQL, 0, 102400);
//		try
//		{
//			TMdbClientDatabase* m_pDataBase = new(std::nothrow) TMdbClientDatabase();
//			m_pDataBase->SetLogin(m_sUser,m_sPassword,m_sDsn);
//			m_pDataBase->SetServer(m_sIP, port);
//			if(m_pDataBase->Connect() == false)
//			{
//				cout << "Connect failed!" << endl;
//			}
//			
//			printf("Execute SQL 1 start.\n");
//			TMdbClientQuery* m_pQuery_1 = m_pDataBase->CreateDBQuery();
////			m_pQuery_1->CloseSQL();
////			m_pQuery_1->SetSQL("select prod_id from prod where prod_id = 1;");
////			m_pQuery_1->Open();
//			printf("Execute SQL 1 end.\n");
//			
//			snprintf(sSQL+strlen(sSQL), sizeof(sSQL)-strlen(sSQL), "%s", "select max(prod_id) from prod where prod_id in (25101661, 25099120, 25100185, 25100192, 25101032, 25100582, 25100579, 25100659, 25100816, 25100870, 25101303, 25101382, 25099034, 25100547, 25100709, 25100584, 25100815, 25100818, 25101116, 25101540, 25100583, 25100639, 25101097, 25103630, 25103636, 25099122, 25100959, 25101121, 25101301, 25099023, 25100182, 25100183, 25100363, 25100398, 25100938, 25100989, 25100152, 25100186, 25100990, 25101295, 25101578, 25101603, 25099084, 25099093, 25101092, 25101117, 25101663, 25103614, 25103615, 25099020, 25099134, 25100307, 25100310, 25100316, 25101057, 25100359, 25100551, 25103564, 25100708, 25100806, 25100807, 25101197, 25100620, 25100689, 25101662, 25099097, 25099104, 25099119, 25105932, 25105959, 25105982, 25099123, 25101386, 25103567, 25106065, 25101387, 25105115, 25105885, 25105925, 25106060, 25101258, 25105400, 25105827, 25105828, 25105941, 25106061, 25106064, 25101299, 25105028, 25105380, 25105419, 25106116, 25106146, 25106147, 25106156, 25106181, 25106183, 25099121, 25104989, 25105476, 25105757, 25105826, 25104902, 25105174, 25105379, 25105981, 25100657, 25100658, 25100721, 25104890, 25104891, 25105528, 25099043, 25099078, 25100197, 25105268, 25105271, 25105277, 25105310, 25105795, 25099083, 25099085, 25099190, 25100163, 25100187, 25100726, 25101056, 25103568, 25099028, 25105824, 25100546, 25105338, 25105339, 25105378, 25105527, 25099091, 25100303, 25100622, 25101294, 25105413, 25105416, 25105478, 25105227, 25106182, 25099069, 25099106, 25106115, 25100298, 25100299, 25100301, 25100302, 25100306, 25105479, 25100143, 25100814, 25105622, 25100315, 25100718, 25105526, 25105575, 25105633, 25100400, 25100555, 25100811, 25100964, 25105276, 25105696, 25105715, 25105719, 25101261, 25101268, 25101297, 25101298, 25101300, 25101505, 25101506, 25101571, 25101577, 25100397, 25100401, 25101383, 25105723, 25105724, 25101660, 25103635, 25104892, 25104921, 25100300, 25101123, 25101124, 25105069, 25105137, 25105772, 25105773, 25105797, 25105996, 25104982, 25105040, 25100823, 25105825, 25105829, 25105881, 25100621, 25101120, 25101122, 25101384, 25105116, 25105627, 25105884, 25105311, 25105313, 25100808, 25105175, 25092020, 25092022, 25092028, 25092040, 25092045, 25092049, 25092055, 25092057, 25092073, 25092079, 25092087, 25092098, 25093115, 25093117, 25093194, 25093328, 25093375, 25093407, 25093420, 25093430, 25093439, 25093441, 25091765, 25091776, 25092068, 25096685, 25096702, 25097208, 25097209, 25097214, 25097215, 25097219, 25097220, 25097238, 25097239, 25097242, 25097243, 25091669, 25091673, 25091684, 25091685, 25091688, 25091693, 25091748, 25091752, 25091761, 25091774, 25091790, 25091791, 25091793, 25091775, 25091786, 25092017, 25092052, 25092063, 25093335, 25096662, 25096677, 25096701, 25096704, 25096708, 25097008, 25097275, 25097276, 25097277, 25097313, 25092062, 25092071, 25092086, 25092101, 25093379, 25093428, 25097316, 25097330, 25097343, 25097350, 25097386, 25091763, 25091782, 25093185, 25096411, 25096414, 25096469, 25096482, 25096699, 25096717, 25096718, 25097432, 25097517, 25091749, 25092004, 25091780, 25096347, 25096350, 25096410, 25096413, 25096415, 25093114, 25096667, 25097518, 25091777, 25092075, 25092080, 25091792, 25096483, 25096484, 25096487, 25093059, 25096857, 25096889, 25096890, 25096892, 25096901, 25096997, 25097523, 25092060, 25092100, 25091674, 25096583, 25096584, 25096592, 25096594, 25096595, 25096598, 25096600, 25096639, 25096684, 25096703, 25097020, 25097039, 25097218, 25097430, 25097449, 25097493, 25091771, 25091772, 25093116, 25096660, 25096661, 25096663, 25096665, 25096666, 25096668, 25096678, 25096679, 25096687, 25096831, 25096888, 25096936, 25097145, 25097186, 25091672, 25093376, 25093440, 25093450, 25096353, 25096695, 25096696, 25096700, 25096705, 25096706, 25096707, 25096709, 25096710, 25096711, 25096712, 25096713, 25096714, 25096715, 25096716, 25096719, 25096765, 25097344, 25091764, 25091766, 25091781, 25092047, 25092054, 25092059, 25092067, 25092072, 25092081, 25093135, 25093329, 25093331, 25093340, 25091956, 25092064, 25092078, 25096766, 25096769, 25096770, 25096774, 25096777, 25096781, 25096784, 25096802, 25096808, 25096587, 25097181, 25097404, 25097412, 25097452, 25092014, 25092027, 25092065, 25092069, 25092077, 25092085, 25093096, 25093109, 25096836, 25096837, 25096863, 25096864, 25096865, 25096894, 25096895, 25096896, 25096897, 25096898, 25096900, 25096904, 25096905, 25096906, 25096907, 25096908, 25096346, 25096348, 25096349, 25096591, 25096593, 25096893, 25097034, 25097184, 25097448, 25097505, 25092023, 25092033, 25092041, 25092048, 25092076, 25093071, 25091689, 25091695, 25091744, 25091800, 25096968, 25096972, 25096975, 25096989, 25097418, 25097429, 25097480, 25093344, 25096999, 25097000, 25097001, 25097003, 25097004, 25097005, 25097006, 25097007, 25097009, 25097012, 25097018, 25097063, 25097064, 25097409, 25091773, 25097019, 25097089, 25097092, 25097097, 25097110, 25097116, 25096354, 25096412, 25093414, 25093426, 25093429, 25096590, 25096599, 25096601, 25096664, 25097151, 25097158, 25097185, 25097191, 25097192, 25097193, 25093338, 25093405, 25093406, 25093454, 25091742, 25091754, 25093377, 25093378, 25093442, 25093448, 25091678, 25091680, 25091686, 25091690, 25091668, 25091670, 25091671, 25091675, 25091676, 25091677, 25091681, 25091683, 25091687, 25091691, 25091692, 25091739, 25091740, 25091743, 25091745, 25091755, 25091760, 25091762, 25091767, 25091768, 25091779, 25091783, 25091784, 25091785, 25091788, 25091789, 25091794, 25091795, 25091796, 25091797, 25092007, 25092013, 25092016, 25092018, 25092019, 25092024, 25092051, 25092056, 25092066, 25092070, 25092074, 25092082, 25092083, 25092088, 25092096, 25092097, 25092102, 25091753, 25091757, 25091799, 25093074, 25093110, 25091741, 25093181, 25093186, 25093187, 25093188, 25093191, 25093310, 25093330, 25093337, 25093342, 25093343, 25093345, 25093346, 25093347, 25093348, 25093351, 25093352, 25093353, 25093373, 25093380, 25093383, 25093384, 25093385, 25093410, 25093417, 25093422, 25093423, 25093424, 25093425, 25093427, 25093431, 25093432, 25093445, 25093446, 25093447, 25093452, 25093453, 25091679, 25091682, 25093167, 25092015, 25092021, 25092044, 25092050, 25092058, 25092084, 25092089, 25092095, 25092099, 25093060, 25093065, 25093107, 25093108, 25093111, 25093192, 25093411, 25093449, 25129605, 25129060, 25129187, 25129316, 25129994, 25129350, 25129157, 25130583, 25129541, 25129596, 25135440, 25129995, 25129225, 25129577, 25129522, 25135217, 25135276, 25129156, 25135329, 25129197, 25129458, 25129567, 25130588, 25135336, 25135385, 25129566, 25129602, 25130167, 25129922, 25129989, 25130204, 25130317, 25130166, 25135335, 25135361, 25130498, 25129668, 25130688, 25130689, 25129961, 25129201, 25117755, 25124114, 25124178, 25124260, 25123645, 25124071, 25124072, 25124074, 25124075, 25124077, 25124078, 25124080, 25124082, 25124083, 25124084, 25124085, 25124088, 25124093, 25124102, 25124111, 25124138, 25118582, 25124287, 25124405, 25123648, 25124087, 25124252, 25124279, 25118452, 25124829, 25118451, 25118460, 25124460, 25124461, 25124463, 25117554, 25118692, 25124724, 25117991, 25123634, 25124536, 25124607, 25118665, 25118818, 25124081, 25124095, 25124141, 25123496, 25124573, 25123363, 25117363, 25123655, 25124117, 25124115, 25117747, 25118817, 25123362, 25123416, 25123415, 25124094, 25124103, 25124156, 25124152, 25124665, 25124096, 25124116, 25117725, 25118666, 25117459, 25124390, 25118815, 25124058, 25124076, 25117863, 25124073, 25124086, 25124462, 25124464, 25124828, 25118453, 25118920, 25124101, 25118091, 25118456, 25117865, 25117682, 25117890, 25118586, 25117458, 25118816, 25117916, 25118321, 25118766, 25117864, 25117989, 25109887, 25110426, 25114121, 25114127, 25114128, 25109202, 25111315, 25111378, 25114016, 25109844, 25109941, 25111139, 25111631, 25110613, 25111990, 25108078, 25112074, 25112092, 25114233, 25114294, 25108186, 25109166, 25109759, 25113381, 25108131, 25108134, 25113594, 25109347, 25108077, 25110136, 25114025, 25114351, 25114913, 25113878, 25109112, 25109113, 25109126, 25110582, 25110135, 25111632, 25114466, 25109162, 25111156, 25109174, 25109795, 25110699, 25114886, 25114887, 25114914,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        25109606, 25110584, 25111297, 25112073, 25117377, 25111805, 25115446, 25115618, 25109175, 25109990, 25111630, 25117393, 25111236, 25110954, 25109502, 25111544, 25108076, 25112076, 25109750, 25110126, 25110137, 25114290, 25108164, 25109884, 25113310, 25110639, 25110920, 25110122, 25114009, 25114010, 25114024, 25111280, 25111543, 25110121, 25110583, 25111989, 25108039, 25110123, 25110991, 25109104, 25114257, 25111225, 25114517, 25114883, 25108040, 25114011, 25108135, 25110891, 25114575, 25110700, 25108167, 25109151, 25109157, 25109334, 25109473, 25109531, 25114350, 25111576, 25114662, 25114915, 25108079, 25108147, 25108148, 25114903, 25114931, 25114947, 25109206, 25111371, 25114810, 25115445, 25115566, 25109575, 25109603, 25110138, 25109998, 25110486, 25110666, 25110879, 25110888, 25114495, 25114496, 25111230, 25108149, 25110972, 25110691, 25110701, 25109123, 25109124, 25109125, 25111842, 25109452, 25109392, 2510945)");
//			printf("Execute SQL 2 start.\n");
//			m_pQuery_1->CloseSQL();
//			m_pQuery_1->SetSQL(sSQL);
//			m_pQuery_1->Open();
//			printf("Execute SQL 2 end.\n");
//			
////			printf("Execute SQL 3 start.\n");
////			TMdbClientQuery* m_pQuery_2 = m_pDataBase->CreateDBQuery();
////			m_pQuery_2->CloseSQL();
////			m_pQuery_2->SetSQL("select prod_id from prod where prod_id = :a;");
////			m_pQuery_2->SetParameter("a", 12345678);
////			m_pQuery_2->Open();
////			printf("Execute SQL 3 end.\n");
//		}
//		catch(TMdbException &e)
//		{
//			
//		}


		/*TMdbDatabase* m_pDataBase1, *m_pDataBase2, *m_pDataBase3, *m_pDataBase4;
		TMdbQuery* m_pQuery;
		
		m_pDataBase1 = new(std::nothrow) TMdbDatabase();
		m_pDataBase1->SetLogin("at", "at", "at");
		if(m_pDataBase1->Connect() == false)
		{
			cout << "Connect failed!" << endl;
		}
		m_pDataBase2 = new(std::nothrow) TMdbDatabase();
		m_pDataBase2->SetLogin("at", "at", "at");
		if(m_pDataBase2->Connect() == false)
		{
			cout << "Connect failed!" << endl;
		}
		m_pDataBase3 = new(std::nothrow) TMdbDatabase();
		m_pDataBase3->SetLogin("jxl", "jxl", "jxl");
		if(m_pDataBase3->Connect() == false)
		{
			cout << "Connect failed!" << endl;
		}
		m_pDataBase4 = new(std::nothrow) TMdbDatabase();
		m_pDataBase4->SetLogin("jxl", "jxl", "jxl");
		if(m_pDataBase4->Connect() == false)
		{
			cout << "Connect failed!" << endl;
		}
		getchar();
		getchar();
		sleep(1000);*/
		/*
		char pk1_base[] = "0000000000000000000000";
		char sPk1[128] = {0};
		int iPk1[10000] = {0};
		
		char * m_sUser = "jxl";
		char * m_sPassword = "jxl";
		char * m_sDsn = "jxl";
		
		try
		{
			TMdbDatabase* m_pDataBase = new(std::nothrow) TMdbDatabase();
			m_pDataBase->SetLogin(m_sUser,m_sPassword,m_sDsn);
			if(m_pDataBase->Connect() == false)
			{
				cout << "Connect failed!" << endl;
			}
			TMdbQuery* m_pQuery = m_pDataBase->CreateDBQuery();
			m_pQuery->CloseSQL();
			
			m_pQuery->SetSQL("delete from varchar_test where 1;");
			m_pQuery->Execute();
			m_pQuery->Commit();
			m_pQuery->Close();
			m_pQuery->SetSQL("insert into varchar_test (pk1) values (:pk1);");
			
			int i = 0;
			time_t timer = time(NULL);
			printf("ctime: %s\n", ctime(&timer));
			for(i = 0; i<5000000; i++)
			{
				if(i!=0 && i%10000 == 0) m_pQuery->Commit();
				snprintf(sPk1, sizeof(sPk1), "%s%d", pk1_base, i);
				m_pQuery->SetParameter(0, sPk1);
				m_pQuery->Execute();
			}
			m_pQuery->Commit();
			timer = time(NULL);
			printf("ctime: %s\n", ctime(&timer));
			
			TMdbQuery* m_pInstQuery = m_pDataBase->CreateDBQuery();
			m_pInstQuery->CloseSQL();
			m_pInstQuery->SetSQL("insert into varchar_test (pk1) values (:pk1);");
			
			TMdbQuery* m_pDelQuery = m_pDataBase->CreateDBQuery();
			m_pDelQuery->CloseSQL();
			m_pDelQuery->SetSQL("delete from varchar_test where pk1 = :pk1;");
			
			TMdbQuery* m_pSelQuery = m_pDataBase->CreateDBQuery();
			m_pSelQuery->CloseSQL();
			m_pSelQuery->SetSQL("select * from varchar_test where pk1 = :pk1;");
			bool bExist = false;
			while(1)
			{
				for(i = 0; i<10000; i++)
				{
					while(1)
					{
						bExist = false;
						iPk1[i] = CJxlRand::GetRandNum(4999999);
						//printf("iPk1[i] = [%d]\n", iPk1[i]);
						snprintf(sPk1, sizeof(sPk1), "%s%d", pk1_base, iPk1[i]);
						m_pSelQuery->SetParameter(0, sPk1);
						m_pSelQuery->Open();
						while(m_pSelQuery->Next())
						{
							bExist = true;
						}
						if(bExist)
						{
							m_pDelQuery->SetParameter(0, sPk1);
							m_pDelQuery->Execute();
							break;
						}
						else
						{
							continue;
						}
					}
				}
				m_pDelQuery->Commit();
				
				for(i = 9999; i>= 0; i--)
				{
					snprintf(sPk1, sizeof(sPk1), "%s%d", pk1_base, iPk1[i]);
					m_pInstQuery->SetParameter(0, sPk1);
					m_pInstQuery->Execute();
				}
				m_pInstQuery->Commit();
				usleep(1000);
			}
		}
		catch(TMdbException &e)
		{
			
		}
		*/
		/*
		char pk1_base[] = "adsfadlkl;kghplakd;ljgoi;werpsa[kgk;kjsa;kldkfjlkwerjhg;lka;ldgj;okerjgh;klajsd;klfj;oiwerhg;lkajef;hwero;gj;akjreg;kojre;odksd";
		char sPk1[128] = {0};
		int iPk2 = 0;
		
		char * m_sUser = "jxl";
		char * m_sPassword = "jxl";
		char * m_sDsn = "jxl";
		
		try
		{
			TMdbDatabase* m_pDataBase = new(std::nothrow) TMdbDatabase();
			m_pDataBase->SetLogin(m_sUser,m_sPassword,m_sDsn);
			if(m_pDataBase->Connect() == false)
			{
				cout << "Connect failed!" << endl;
			}
			
			TMdbQuery* m_pInstQuery = m_pDataBase->CreateDBQuery();
			m_pInstQuery->CloseSQL();
			m_pInstQuery->SetSQL("insert into RESERVE_BAL (SESSION_ID, BAL_ID, ACCT_ID, BAL_SHARE_ID, USED_BAL, RESERVE_BAL, UPDATE_DATE) values (:SESSION_ID, :BAL_ID, :ACCT_ID, :BAL_SHARE_ID, :USED_BAL, :RESERVE_BAL, sysdate);");
			
			TMdbQuery* m_pDelQuery = m_pDataBase->CreateDBQuery();
			m_pDelQuery->CloseSQL();
			m_pDelQuery->SetSQL("delete from RESERVE_BAL where BAL_ID = :BAL_ID;");
			
			while(1)
			{
				for(int i = 0; i<1000; i++)
				{
					delete_test(m_pDelQuery, CJxlRand::GetRandNum(9999999));
					iPk2 = CJxlRand::GetRandNum(9999999);
					snprintf(sPk1, CJxlRand::GetRandNum(75, 115), "%s", pk1_base);
					snprintf(sPk1+strlen(sPk1), sizeof(sPk1) - strlen(sPk1), "%d", iPk2);
					insert_test(m_pInstQuery, sPk1, iPk2);
				}
				m_pDelQuery->Commit();
				usleep(1000);
			}
		}
		catch(TMdbException &e)
		{
			
		}*/
		
		
		char * m_sUser = "jxl";
		char * m_sPassword = "jxl";
		char * m_sDsn = "jxl";
		
		char sValue[8196] = {'A'};
		unsigned char buffer[10240] = {0};
		int iLen = 0;
		try
		{
			TMdbDatabase* m_pDataBase = new(std::nothrow) TMdbDatabase();
			m_pDataBase->SetLogin(m_sUser,m_sPassword,m_sDsn);
			if(m_pDataBase->Connect() == false)
			{
				cout << "Connect failed!" << endl;
			}
			
			TMdbQuery* m_pQuery = m_pDataBase->CreateDBQuery();
			m_pQuery->CloseSQL();
			m_pQuery->SetSQL("delete from numpk_mdb2mdb where pk1 = 1;");
			m_pQuery->Execute();
			m_pQuery->CloseSQL();
			m_pQuery->SetSQL("insert into numpk_mdb2mdb (pk1, col_blob)values(1,sValue,8191);");
			m_pQuery->SetParameter(0, sValue);
			m_pQuery->Execute();
			TMdbQuery* m_pQuery1 = m_pDataBase->CreateDBQuery();
			m_pQuery1->CloseSQL();
			m_pQuery1->SetSQL("select col_blob from numpk_mdb2mdb where pk1 = 1;");
			while(m_pQuery1->Next())
			{
				m_pQuery1->Field(0).AsBlobBuffer(buffer,iLen);
				printf("bingo. iLen = [%d], col_blob = [%s]\n", iLen, buffer);
			}
		}
		catch(TMdbException &e)
		{
			
		}
		
		
//		//printf("TEST START.\n");
//		
//		char * m_sUser = "qmdb12aix";
//		char * m_sPassword = "smart";
//		char * m_sDsn = "pcc";
//		
//		try
//		{
//			TMDBDBInterface* m_pDBLink;   //
//    		TMDBDBQueryInterface*    m_pOraQuery;    //
//			m_pDBLink = TMDBDBFactory::CeatDB();
//	        m_pDBLink->SetLogin(m_sUser, m_sPassword, m_sDsn);
//	        bFlag = m_pDBLink->Connect();
//	        m_pOraQuery = m_pDBLink->CreateDBQuery();
//	        m_pOraQuery->Close();
//			m_pOraQuery->SetSQL("insert into jxl_test_2 (pk1, col_num1) values (:pk1, :col_num1);");
//	        m_pOraQuery->SetParameter("pk1" ,1);
//	        m_pOraQuery->SetParameter("col_num1" ,999999999999999999);
//	        m_pOraQuery->Execute();
//	        m_pOraQuery->Commit();
//		}
//		catch(TMDBDBExcpInterface &oe)
//	    {
//	        printf("TDBException:%s\n",oe.GetErrMsg());
//	        printf("QuerySQL:\n%s\n",oe.GetErrSql());
//	    }

//		char * m_sUser = "jxl";
//		char * m_sPassword = "jxl";
//		char * m_sDsn = "jxl";
//		
//		char sValue[8196] = {0};
//		memset(sValue, 'a', 8196);
//		sValue[32] = 0;
//		sValue[64] = 0;
//		for(int i = 0; i< 256; i++)
//		{
//			printf("sValue[%d] = [%c]\n", i, sValue[i]);	
//		}
//		try
//		{
//			TMdbDatabase* m_pDataBase = new(std::nothrow) TMdbDatabase();
//			m_pDataBase->SetLogin(m_sUser,m_sPassword,m_sDsn);
//			if(m_pDataBase->Connect() == false)
//			{
//				cout << "Connect failed!" << endl;
//			}
//			
//			
//			TMdbQuery* m_pInsertQuery = m_pDataBase->CreateDBQuery();
//			m_pInsertQuery->CloseSQL();
//			m_pInsertQuery->SetSQL("insert into numpk_mdb2mdb (pk1, col_blob) values (0, :col_blobadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdf);");
//			m_pInsertQuery->SetParameter("col_blobadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdf", sValue, 128);
//			m_pInsertQuery->Execute();
//			m_pInsertQuery->Commit();
//			
//			unsigned char sRes[1024] = {'b'};
//			memset(sRes, 'b', 1024);
//			int iLen = 0;
//			TMdbQuery* m_pQuery = m_pDataBase->CreateDBQuery();
//			m_pQuery->CloseSQL();
//			m_pQuery->SetSQL("select col_blob from numpk_mdb2mdb where pk1=0;");
//			m_pQuery->Open();
//			while(m_pQuery->Next())
//			{
//				m_pQuery->Field("col_blob").AsBlobBuffer(sRes, iLen);
//			}
//			for(int i = 0; i< 256; i++)
//			{
//				printf("sRes[%d] = [%c]\n", i, sRes[i]);	
//			}
//		}
//		catch(TMdbException &e)
//		{
//			
//		}

//		char * m_sUser = "jxl";
//		char * m_sPassword = "jxl";
//		char * m_sDsn = "jxl";
//		char * m_sIP = "10.45.5.162";
//		int port = 17934;
//		
//		char sValue[8196] = {0};
//		memset(sValue, 'a', 8196);
//		sValue[32] = 0;
//		sValue[64] = 0;
//		try
//		{
//			TMdbClientDatabase* m_pDataBase = new(std::nothrow) TMdbClientDatabase();
//			m_pDataBase->SetLogin(m_sUser,m_sPassword,m_sDsn);
//			m_pDataBase->SetServer(m_sIP, port);
//			if(m_pDataBase->Connect() == false)
//			{
//				cout << "Connect failed!" << endl;
//			}
//			
//			
//			TMdbClientQuery* m_pInsertQuery = m_pDataBase->CreateDBQuery();
//			m_pInsertQuery->CloseSQL();
//			m_pInsertQuery->SetSQL("insert into numpk_mdb2mdb (pk1, col_blob) values (0, :col_blobadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdf);");
//			m_pInsertQuery->SetParameter("col_blobadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdfadsfadfasdf", sValue, 128);
//			m_pInsertQuery->Execute();
//			m_pInsertQuery->Commit();
//		}
//		catch(TMdbException &e)
//		{
//			
//		}



//		//printf("TEST START.\n");
//		
//		char * m_sUser = "qcc";
//		char * m_sPassword = "smart";
//		char * m_sDsn = "qcc32";
//		
//		try
//		{
//			TMDBDBInterface* m_pDBLink;   //
//    		TMDBDBQueryInterface*    m_pOraQuery;    //
//			m_pDBLink = TMDBDBFactory::CeatDB();
//	        m_pDBLink->SetLogin(m_sUser, m_sPassword, m_sDsn);
//	        m_pDBLink->Connect();
//	        m_pOraQuery = m_pDBLink->CreateDBQuery();
//	        m_pOraQuery->Close();
//			m_pOraQuery->SetSQL("select prod_id from prod where prod_id > 0");
//	        m_pOraQuery->Open();
//	        while(m_pOraQuery->Next())
//	        {
//	        	
//	        	usleep(1000);
//	        }
//		}
//		catch(TMDBDBExcpInterface &oe)
//	    {
//	        printf("TDBException:%s\n",oe.GetErrMsg());
//	        printf("QuerySQL:\n%s\n",oe.GetErrSql());
//	    }
//	    catch(...)
//	    {
//	    	
//	    	printf("Unknown exception.\n");
//	    }

		
	}
}

